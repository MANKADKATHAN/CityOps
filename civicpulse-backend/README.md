# CivicPulse Backend

A simple, hackathon-friendly backend for the CivicPulse AI issue reporting system. Built with **FastAPI** and **Supabase**.

## ðŸš€ Setup & Installation

### 1. Prerequisites
- Python 3.8 or higher
- A Supabase account and project

### 2. Install Dependencies
Open your terminal in this folder and run:
```bash
pip install -r requirements.txt
```

### 3. Configure Environment Variables
Create a file named `.env` in this folder (or set them in your system environment) with your Supabase credentials:

```ini
SUPABASE_URL="https://your-project.supabase.co"
SUPABASE_ANON_KEY="your-anon-key-here"
```

### 4. Supabase Database Setup
Go to your Supabase SQL Editor and run this SQL to create the table:

```sql
CREATE TABLE complaints (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    complaint_id UUID NOT NULL,
    issue_type TEXT,
    description TEXT,
    location_text TEXT,
    latitude FLOAT,
    longitude FLOAT,
    assigned_department TEXT,
    priority TEXT,
    status TEXT DEFAULT 'Pending',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### 5. Run the Server
```bash
python main.py
```
The server will start at `http://0.0.0.0:8000`.

---

## ðŸ“– API Documentation

Once the server is running, open your browser to:
**[http://localhost:8000/docs](http://localhost:8000/docs)**  
This gives you an interactive UI to test all endpoints.

### Key Endpoints

#### 1. **Health Check**
- **GET** `/health`
- **Response**: `{"status": "ok"}`

#### 2. **AI Chatbot (Simulation)**
- **POST** `/chat`
- **Body**:
  ```json
  {
    "message": "There is garbage near the main gate in Maninagar"
  }
  ```
- **Response**:
  ```json
  {
    "assistantReply": "I noticed you're ...",
    "extractedData": {
      "issue_type": "Garbage",
      "description": "...",
      "location_text": "main gate in Maninagar"
    }
  }
  ```

#### 3. **Submit Complaint**
- **POST** `/complaints`
- **Body**:
  ```json
  {
    "issue_type": "Garbage",
    "description": "Garbage pile at corner",
    "location_text": "Maninagar",
    "latitude": 23.01,
    "longitude": 72.57,
    "assigned_department": "Sanitation",
    "priority": "High"
  }
  ```
- **Response**: `{"success": true, "complaint_id": "..."}`
